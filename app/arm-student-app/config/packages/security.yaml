security:
  access_denied_url: /accessDenied
  # https://symfony.com/doc/current/security.html#registering-the-user-hashing-passwords
  password_hashers:
    Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface: 'auto'
  # https://symfony.com/doc/current/security.html#loading-the-user-the-user-provider
  providers:
    # used to reload user from session & other features (e.g. switch_user)
    app_user_provider:
      entity:
        class: App\Entity\User
        property: email
  firewalls:
    dev:
      pattern: ^/(_(profiler|wdt)|css|images|js)/
      security: true
    main:
      lazy: true
      provider: app_user_provider
      form_login:
        login_path: app_sign_in
        check_path: app_sign_in
        default_target_path: /secure
        enable_csrf: true
      logout:
        path: app_sign_out

  role_hierarchy:
    ## Для всех ролей созданы под роли со следующими обозначениям:
    ## C  CREATE  создание записей
    ## R  READ    чтение записей
    ## U  UPDATE  изменение записей
    ## D  DELETE  удаление записей
    ## F  FULL    Разрешено всё
    ## IMP IMPORT - Импорт данных в сущность
    ##
    ##
    ## В системе предусмотрено следующие типы пользователей
    ##
    ##  STUD    STUDENT   студент
    ##  STAFF   STAFF     сотрудник
    ##  ROOT    ROOT      Супер-пользователь
    ##  ADM     ADMIN     Пользователь с правами администратора
    ##
    ## !!ПРАВИЛА ФОРМИРОВАНИЯ НАИМЕНОВАНИЯ РОЛИ
    ## Любая роль именуется по следующей схеме ROLE_[ТИП ПОЛЬЗОВАТЕЛЯ]_[СУЩНОСТЬ]_[ПРАВА/ГРУППА ПРАВ]



    ##ENTITY ROLES
    ##!!ENT_STUDENTS
    ROLE_STAFF_STUDENT_C: ROLE_STAFF_STUDENT_C
    ROLE_STAFF_STUDENT_R: ROLE_STAFF_STUDENT_R
    ROLE_STAFF_STUDENT_U: ROLE_STAFF_STUDENT_U
    ROLE_STAFF_STUDENT_D: ROLE_STAFF_STUDENT_D
    ROLE_STAFF_STUDENT_IMP: ROLE_STAFF_STUDENT_IMP
    ##Группы ролей

    ROLE_STAFF_STUDENT_FULL: [ ROLE_STAFF_STUDENT_C,ROLE_STAFF_STUDENT_R,ROLE_STAFF_STUDENT_U,ROLE_STAFF_STUDENT_D,ROLE_STAFF_STUDENT_IMP ]
    ROLE_STAFF_STUDENT_RU: [ ROLE_STAFF_STUDENT_R,ROLE_STAFF_STUDENT_U ]
    ROLE_STAFF_STUDENT_CRU: [ ROLE_STAFF_STUDENT_C,ROLE_STAFF_STUDENT_R,ROLE_STAFF_STUDENT_U ]

    ##ENT_STUDENTS!!

    ##ENT_AB_PETITIONS
    ## VIS - взаимодействие с API внешней системы prof.mo.mosreg.ru
    ## SITE - взаимодействие с БД сайта
    ## MANUAL_C - ручное создание заявлений
    ## ENROLL - рекомендация к зачислению
    ## INDUCT - Выполняет зачисление.
    ##          Связан с ролями:
    ##           - чтения списка приказов о движении
    ##           - редактирования приказов о движении

    ROLE_STAFF_AB_PETITIONS_C: ROLE_STAFF_AB_PETITIONS_C
    ROLE_STAFF_AB_PETITIONS_R: ROLE_STAFF_AB_PETITIONS_R
    ROLE_STAFF_AB_PETITIONS_U: ROLE_STAFF_AB_PETITIONS_U
    ROLE_STAFF_AB_PETITIONS_D: ROLE_STAFF_AB_PETITIONS_D
    ROLE_STAFF_AB_PETITIONS_IMP: ROLE_STAFF_AB_PETITIONS_IMP
    ROLE_STAFF_AB_PETITIONS_VIS: [ ROLE_STAFF_AB_PETITIONS_VIS, ]
    ROLE_STAFF_AB_PETITIONS_SITE: ROLE_STAFF_AB_PETITIONS_SITE
    ROLE_STAFF_AB_PETITIONS_MANUAL_C: [ ROLE_STAFF_AB_PETITIONS_C,ROLE_STAFF_AB_PETITIONS_MANUAL_C ]
    ROLE_STAFF_AB_PETITIONS_ENROLL: ROLE_STAFF_AB_PETITIONS_ENROLL
    ROLE_STAFF_AB_PETITIONS_INDUCT: [ ROLE_STAFF_AB_PETITIONS_INDUCT,ROLE_STAFF_CONT_DOC_RU,ROLE_STAFF_USER_CRU, ROLE_STAFF_COLLEGE_R ]
    ##ToDo: ROLE_STAFF_AB_PETITIONS_INDUCT - Добавить права для документов о движении чтение и редактирование,
    ##ToDo: ROLE_STAFF_AB_PETITIONS_INDUCT - Добавить права на чтение,создание пользователей
    ##ToDo: ROLE_STAFF_AB_PETITIONS_INDUCT - Добавить права на чтение информации о колледже

    ##Группы ролей
    ROLE_STAFF_AB_PETITIONS_FULL: [ ROLE_STAFF_AB_PETITIONS_C,ROLE_STAFF_AB_PETITIONS_R,ROLE_STAFF_AB_PETITIONS_U,ROLE_STAFF_AB_PETITIONS_D,ROLE_STAFF_AB_PETITIONS_IMP,ROLE_STAFF_AB_PETITIONS_VIS,ROLE_STAFF_AB_PETITIONS_MANUAL_C,ROLE_STAFF_AB_PETITIONS_SITE,ROLE_STAFF_AB_PETITIONS_ENROLL,ROLE_STAFF_AB_PETITIONS_INDUCT ]
    ROLE_STAFF_AB_PETITIONS_CR: [ ROLE_STAFF_AB_PETITIONS_C,ROLE_STAFF_AB_PETITIONS_R ]
    ROLE_STAFF_AB_PETITIONS_CRU: [ ROLE_STAFF_AB_PETITIONS_C,ROLE_STAFF_AB_PETITIONS_R,ROLE_STAFF_AB_PETITIONS_U ]
    ##ENT_AB_PETITIONS!!

    ##ENT_AdmissionExamination
    ROLE_STAFF_ADMISSION_EXAMINATION_C: ROLE_STAFF_ADMISSION_EXAMINATION_C
    ROLE_STAFF_ADMISSION_EXAMINATION_R: ROLE_STAFF_ADMISSION_EXAMINATION_R
    ROLE_STAFF_ADMISSION_EXAMINATION_U: ROLE_STAFF_ADMISSION_EXAMINATION_U
    ROLE_STAFF_ADMISSION_EXAMINATION_D: ROLE_STAFF_ADMISSION_EXAMINATION_D
    ROLE_STAFF_ADMISSION_EXAMINATION_P: ROLE_STAFF_ADMISSION_EXAMINATION_P
    ROLE_STAFF_ADMISSION_EXAMINATION_FULL: [ ROLE_STAFF_ADMISSION_EXAMINATION_C,ROLE_STAFF_ADMISSION_EXAMINATION_R,ROLE_STAFF_ADMISSION_EXAMINATION_U,ROLE_STAFF_ADMISSION_EXAMINATION_D, ROLE_STAFF_ADMISSION_EXAMINATION_P]
    ROLE_STAFF_ADMISSION_EXAMINATION_CR: [ ROLE_STAFF_ADMISSION_EXAMINATION_C,ROLE_STAFF_ADMISSION_EXAMINATION_R ]
    ROLE_STAFF_ADMISSION_EXAMINATION_CRU: [ ROLE_STAFF_ADMISSION_EXAMINATION_C,ROLE_STAFF_ADMISSION_EXAMINATION_R,ROLE_STAFF_ADMISSION_EXAMINATION_U ]


    ##ENT_AdmissionExaminationSubject
    ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_C: ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_C
    ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_R: ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_R
    ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_U: ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_U
    ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_D: ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_D
    ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_FULL: [ ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_C,ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_R,ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_U,ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_D]
    ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_CR: [ ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_C,ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_R ]
    ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_CRU: [ ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_C,ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_R,ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_U ]

    ##ENT_CONTINGENT_DOCUMENT

    ROLE_STAFF_CONT_DOC_C: ROLE_STAFF_CONT_DOC_C
    ROLE_STAFF_CONT_DOC_R: ROLE_STAFF_CONT_DOC_R
    ROLE_STAFF_CONT_DOC_U: ROLE_STAFF_CONT_DOC_U
    ROLE_STAFF_CONT_DOC_D: ROLE_STAFF_CONT_DOC_D
    ROLE_STAFF_CONT_DOC_PRINT: ROLE_STAFF_CONT_DOC_PRINT


    ROLE_STAFF_CONT_DOC_FULL: [ ROLE_STAFF_CONT_DOC_C,ROLE_STAFF_CONT_DOC_R,ROLE_STAFF_CONT_DOC_U,ROLE_STAFF_CONT_DOC_D ]
    ROLE_STAFF_CONT_DOC_CR: [ ROLE_STAFF_CONT_DOC_C,ROLE_STAFF_CONT_DOC_R ]
    ROLE_STAFF_CONT_DOC_RU: [ ROLE_STAFF_CONT_DOC_R,ROLE_STAFF_CONT_DOC_U ]
    ROLE_STAFF_CONT_DOC_CRU: [ ROLE_STAFF_CONT_DOC_C,ROLE_STAFF_CONT_DOC_R,ROLE_STAFF_CONT_DOC_U ]


    ##ENT_COLLEGE




    ROLE_STAFF_COLLEGE_C: ROLE_STAFF_COLLEGE_C
    ROLE_STAFF_COLLEGE_R: ROLE_STAFF_COLLEGE_R
    ROLE_STAFF_COLLEGE_U: ROLE_STAFF_COLLEGE_U
    ROLE_STAFF_COLLEGE_D: ROLE_STAFF_COLLEGE_D
    ROLE_STAFF_COLLEGE_PRINT: ROLE_STAFF_COLLEGE_PRINT


    ROLE_STAFF_COLLEGE_FULL: [ ROLE_STAFF_COLLEGE_C,ROLE_STAFF_COLLEGE_R,ROLE_STAFF_COLLEGE_U,ROLE_STAFF_COLLEGE_D ]
    ROLE_STAFF_COLLEGE_CR: [ ROLE_STAFF_COLLEGE_C,ROLE_STAFF_COLLEGE_R ]
    ROLE_STAFF_COLLEGE_CRU: [ ROLE_STAFF_COLLEGE_C,ROLE_STAFF_COLLEGE_R,ROLE_STAFF_COLLEGE_U ]

    ##ENT_COLLEGE!!

    ##ENT_USER

    ROLE_STAFF_USER_C: ROLE_STAFF_USER_C
    ROLE_STAFF_USER_R: ROLE_STAFF_USER_R
    ROLE_STAFF_USER_U: ROLE_STAFF_USER_U
    ROLE_STAFF_USER_D: ROLE_STAFF_USER_D
    ROLE_STAFF_USER_PRINT: ROLE_STAFF_USER_PRINT


    ROLE_STAFF_USER_FULL: [ ROLE_STAFF_USER_C,ROLE_STAFF_USER_R,ROLE_STAFF_USER_U,ROLE_STAFF_USER_D ]
    ROLE_STAFF_USER_CR: [ ROLE_STAFF_USER_C,ROLE_STAFF_USER_R ]
    ROLE_STAFF_USER_CRU: [ ROLE_STAFF_USER_C,ROLE_STAFF_USER_R,ROLE_STAFF_USER_U ]

    ##ENT_USER!!


    ROLE_CL: [ ROLE_STAFF_STUDENT_RU,ROLE_USER ]
    ROLE_STUDENT: [ ROLE_STUDENT,ROLE_USER ]
    ROLE_USER: ROLE_USER
    ROLE_ROOT: [ ROLE_ALLOWED_TO_SWITCH, ROLE_STAFF_STUDENT_FULL, ROLE_STAFF_AB_PETITIONS_FULL, ROLE_STAFF_CONT_DOC_FULL, ROLE_STAFF_COLLEGE_FULL,ROLE_STAFF_ADMISSION_EXAMINATION_FULL,ROLE_STAFF_ADMISSION_EXAMINATION_SUBJECT_FULL ]
    ROLE_ADMIN: ROLE_ADM
    ROLE_ZAM_UR: [ ROLE_STAFF_STUDENT_FULL ]
    ROLE_ADMISS_ADMIN: [ ROLE_STAFF_AB_PETITIONS_FULL, ROLE_USER ]



    # activate different ways to authenticate
    # https://symfony.com/doc/current/security.html#the-firewall

    # https://symfony.com/doc/current/security/impersonating_user.html
    # switch_user: true

    # Простой способ контролировать доступ к большим разделам вашего сайта
  # Примечание: будет использоваться только *первый* соответствующий элемент управления доступом.
  access_control:
    - { path: ^/_profiler/, roles: ROLE_ROOT}
    - { path: ^/sign_in, role: PUBLIC_ACCESS }
    - { path: ^/accessDenied, role: PUBLIC_ACCESS }
    - { path: ^/student-app, roles: [ ROLE_STUDENT ] }
    - { path: ^/contingent , roles: [ROLE_USER]}

when@test:
  security:
    password_hashers:
      # By default, password hashers are resource intensive and take time. This is
      # important to generate secure password hashes. In tests however, secure hashes
      # are not important, waste resources and increase test times. The following
      # reduces the work factor to the lowest possible values.
      Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface:
        algorithm: auto
        cost: 4 # Lowest possible value for bcrypt
        time_cost: 3 # Lowest possible value for argon
        memory_cost: 10 # Lowest possible value for argon
